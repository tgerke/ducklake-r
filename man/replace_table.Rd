% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/replace_table.R
\name{replace_table}
\alias{replace_table}
\title{Replace a table with modified data and create a new snapshot}
\usage{
replace_table(.data, table_name, .quiet = TRUE)
}
\arguments{
\item{.data}{A dplyr query object (tbl_lazy) with transformations}

\item{table_name}{Table name to replace}

\item{.quiet}{Logical, whether to suppress messages (default TRUE)}
}
\value{
Invisibly returns NULL
}
\description{
Replace a table with modified data and create a new snapshot
}
\details{
This function is designed for schema changes or bulk transformations that should
create a new versioned snapshot. It:
\enumerate{
\item Collects the transformed data
\item Drops the existing table
\item Creates a new table with the updated schema/data
}

All operations happen within the current transaction context. Use
\code{begin_transaction()} and \code{commit_transaction()} to ensure proper versioning.

\strong{When to use replace_table():}
\itemize{
\item \strong{Adding new columns} - DuckLake UPDATE cannot add columns; use replace_table()
\item \strong{Removing columns} - Restructure schema with select()
\item \strong{Versioning needed} - Creates snapshots via DROP + CREATE for time travel
\item \strong{Complex transformations} - Apply full dplyr pipelines naturally
}

\strong{When to use update_table() instead:}
\itemize{
\item Modifying existing column values only (no schema changes)
\item Performance critical and versioning not needed
\item Making targeted corrections to specific rows
}
}
\examples{
\dontrun{
# Add new derived columns with versioning
begin_transaction()
get_ducklake_table("adsl") |>
  mutate(
    AGE65FL = if_else(AGE >= 65, "Y", "N"),
    AGECAT = case_when(
      AGE < 65 ~ "<65",
      AGE >= 65 & AGE < 75 ~ "65-74",
      AGE >= 75 ~ ">=75"
    )
  ) |>
  replace_table("adsl")
commit_transaction()

# Remove columns and create new snapshot
begin_transaction()
get_ducklake_table("adsl") |>
  select(-AGE65FL, -AGECAT) |>
  replace_table("adsl")
commit_transaction()
}
}
