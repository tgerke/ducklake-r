% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rows_operations.R
\name{rows_upsert}
\alias{rows_upsert}
\title{Upsert rows in a DuckLake table}
\usage{
rows_upsert(
  x,
  y,
  by = NULL,
  copy = TRUE,
  in_place = TRUE,
  author = NULL,
  commit_message = NULL,
  commit_extra_info = NULL,
  ...
)
}
\arguments{
\item{x}{Target table (from get_ducklake_table())}

\item{y}{Data frame with rows to upsert (update existing, insert new)}

\item{by}{Column(s) to match on}

\item{copy}{Whether to copy y to the same source as x (default TRUE)}

\item{in_place}{Whether to modify the table in place (default TRUE for DuckLake)}

\item{author}{Optional author name to associate with the snapshot}

\item{commit_message}{Optional commit message describing the changes}

\item{commit_extra_info}{Optional extra information about the commit}

\item{...}{Additional arguments passed to dplyr::rows_upsert()}
}
\value{
The updated table
}
\description{
A wrapper around dplyr::rows_upsert() with in_place = TRUE as the default,
since DuckLake is designed for in-place modifications. Optionally adds
snapshot metadata after the operation completes.
}
\details{
This function performs an upsert operation: updates existing rows and inserts
new ones. Rows are matched using the columns specified in \code{by}.

If \code{author}, \code{commit_message}, or \code{commit_extra_info} are provided,
they will be added to the snapshot metadata after the upsert completes.
}
\examples{
\dontrun{
# Basic upsert
rows_upsert(
  get_ducklake_table("my_table"),
  data.frame(id = c(1, 99), value = c("updated", "new")),
  by = "id"
)

# Upsert with metadata
rows_upsert(
  get_ducklake_table("my_table"),
  data.frame(id = c(1, 99), value = c("updated", "new")),
  by = "id",
  author = "Data Team",
  commit_message = "Update and add records"
)
}
}
\seealso{
\code{\link[=upsert_table]{upsert_table()}} for pipeline-based upserts using dplyr transformations
}
